option(NO_REACTOS_BUILDNO "If true, disables the generation of buildno.h and version.h for each configure" OFF)

if (NOT NO_REACTOS_BUILDNO)
    string(TIMESTAMP KERNEL_VERSION_BUILD %Y%m%d-%H%M UTC)
else()
    set(KERNEL_VERSION_BUILD "custom")
endif()

set(KERNEL_VERSION_MAJOR "6")
set(KERNEL_VERSION_MINOR "1")
set(KERNEL_VERSION_PATCH_LEVEL "6801")
set(KERNEL_VERSION_REVISION "1")
set(COPYRIGHT_YEAR "2025")
set(KERNEL_VERSION_BUILDLAB "aurora")
set(OS_VERSION "${KERNEL_VERSION_MAJOR}.${KERNEL_VERSION_MINOR}")
set(OS_BUILD "${KERNEL_VERSION_PATCH_LEVEL}.${KERNEL_VERSION_REVISION}")
set(OS_DETAILS "${OS_BUILD}.${KERNEL_VERSION_BUILDLAB}.${KERNEL_VERSION_BUILD}")

set(KERNEL_VERSION "${KERNEL_VERSION_MAJOR}.${KERNEL_VERSION_MINOR}.${KERNEL_VERSION_PATCH_LEVEL}.${KERNEL_VERSION_REVISION}")
if(NOT KERNEL_VERSION_BUILDLAB STREQUAL "")
    set(KERNEL_VERSION "${KERNEL_VERSION}")
endif()

math(EXPR REACTOS_DLL_VERSION_MAJOR "${KERNEL_VERSION_MAJOR}+42")
set(DLL_VERSION_STR "${REACTOS_DLL_VERSION_MAJOR}.${KERNEL_VERSION_MINOR}.${KERNEL_VERSION_PATCH_LEVEL}.${KERNEL_VERSION_REVISION}")
if(NOT KERNEL_VERSION_BUILDLAB STREQUAL "")
    set(DLL_VERSION_STR "${DLL_VERSION_STR}")
endif()

# Get Git revision through "git describe"
set(COMMIT_HASH "")
set(REVISION "")

configure_file(sdk/include/reactos/version.h.cmake ${REACTOS_BINARY_DIR}/sdk/include/reactos/version.h)
configure_file(sdk/include/reactos/buildno.h.cmake ${REACTOS_BINARY_DIR}/sdk/include/reactos/buildno.h)
