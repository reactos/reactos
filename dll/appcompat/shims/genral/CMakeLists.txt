
include_directories(${SHIMLIB_DIR})

spec2def(acgenral.dll genral.spec)

list(APPEND SOURCE
    ignoredbgout.c
    ignorefreelib.c
    main.c
    shimtest.c
    themes.c
    genral.spec)

if(ARCH STREQUAL "amd64")
    list(APPEND SOURCE msys2.c)
    list(APPEND ASM_SOURCE msys2.S)

    add_asm_files(acgenral_asm ${ASM_SOURCE})
endif()

add_library(acgenral MODULE
    ${SOURCE}
    ${acgenral_asm}
    ${CMAKE_CURRENT_BINARY_DIR}/acgenral.def)

set_module_type(acgenral win32dll ENTRYPOINT DllMain 12)
target_link_libraries(acgenral shimlib)
add_importlibs(acgenral uxtheme kernel32 ntdll)
add_cd_file(TARGET acgenral DESTINATION reactos/AppPatch FOR all)
